<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0, minimum-scale=0.5, user-scalable=yes">
    <title>绝区零技能芯片计算器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            margin: 0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            min-width: 320px;
            width: 100%;
            transform-origin: center top;
        }

        /* PC端缩放适配 */
        @media screen and (min-width: 769px) {
            .container {
                padding: max(10px, min(30px, 2vw));
                margin: max(5px, min(20px, 1vw)) auto;
                max-width: min(1200px, 95vw);
            }

            .main-content {
                gap: max(10px, min(30px, 2.5vw));
                height: min(calc(100vh - 120px), max(500px, 85vh));
            }

            .left-panel {
                min-width: max(250px, min(400px, 35vw));
            }

            .right-panel {
                flex: 0 0 max(240px, min(350px, 30vw));
            }
        }

        /* 缩放级别适配 */
        @media screen and (min-width: 769px) and (max-width: 900px) {
            .container {
                padding: 15px;
                max-width: 100%;
            }

            .main-content {
                gap: 15px;
                height: calc(100vh - 100px);
            }

            .left-panel {
                min-width: 280px;
            }

            .right-panel {
                flex: 0 0 260px;
            }
        }

        @media screen and (min-width: 901px) and (max-width: 1200px) {
            .container {
                padding: 18px;
            }

            .main-content {
                gap: 18px;
            }
        }

        @media screen and (min-width: 1201px) {
            .container {
                padding: 20px;
                max-width: 1000px;
            }

            .main-content {
                gap: 20px;
                height: calc(100vh - 120px);
            }
        }

        /* JavaScript 动态缩放适配 */
        .zoom-aware {
            transition: all 0.2s ease;
        }

        /* 移动端适配 */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }

            .container {
                padding: 15px;
                border-radius: 10px;
            }

            h1 {
                font-size: 1.6em;
                margin-bottom: 15px;
            }

            .main-content {
                flex-direction: column;
                gap: 15px;
                height: auto;
                min-height: auto;
            }

            .left-panel {
                min-width: auto;
            }

            .right-panel {
                flex: 1;
                min-width: auto;
            }

            .section {
                padding: 15px;
                margin-bottom: 15px;
            }

            .section-title {
                font-size: 1.1em;
                margin-bottom: 12px;
            }

            .skill-item {
                padding: 10px;
            }

            .skill-name {
                font-size: 0.9em;
            }

            .skill-level {
                font-size: 0.75em;
                padding: 2px 6px;
            }

            .chips-section {
                padding: 15px;
                margin-bottom: 15px;
            }

            .result-section {
                padding: 12px;
            }

            .result-title {
                font-size: 1em;
                margin-bottom: 10px;
            }

            .result-content {
                gap: 10px;
            }

            .result-item {
                padding: 6px;
            }

            .result-item .chip-type {
                font-size: 0.8em;
            }

            .result-item .value {
                font-size: 1em;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
                border-radius: 8px;
            }

            h1 {
                font-size: 1.4em;
                margin-bottom: 12px;
            }

            .main-content {
                gap: 12px;
            }

            .section {
                padding: 12px;
                margin-bottom: 12px;
            }

            .section-title {
                font-size: 1em;
                margin-bottom: 10px;
            }

            .skill-item {
                padding: 8px;
                gap: 8px;
            }

            .skill-name {
                font-size: 0.85em;
            }

            .skill-level {
                font-size: 0.7em;
                padding: 2px 5px;
            }

            .skill-slider-container {
                margin-bottom: 5px;
            }

            .skill-levels {
                font-size: 0.7em;
                margin-top: 3px;
            }

            .chip-item {
                padding: 8px;
            }

            .chip-label {
                font-size: 0.85em;
                flex: 0 0 60px;
            }

            .chip-input {
                font-size: 13px;
                padding: 6px;
            }

            .calculate-btn {
                padding: 10px;
                font-size: 14px;
            }

            .result-section {
                padding: 10px;
            }

            .result-title {
                font-size: 0.95em;
                margin-bottom: 8px;
            }

            .result-content {
                gap: 8px;
                flex-direction: column;
            }

            .result-item {
                padding: 5px;
            }

            .result-item .chip-type {
                font-size: 0.75em;
            }

            .result-item .value {
                font-size: 0.9em;
            }

            .info-text {
                font-size: 0.75em;
                margin-top: 6px;
            }
        }

        .main-content {
            display: flex;
            gap: 20px;
            height: calc(100vh - 140px);
            min-height: 500px;
        }

        .left-panel {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
        }

        .right-panel {
            flex: 0 0 280px;
            display: flex;
            flex-direction: column;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 2em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section {
            background: white;
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .section-title {
            font-size: 1.2em;
            color: #333;
            margin-bottom: 15px;
            font-weight: bold;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }

        .skills-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 12px;
            flex: 1;
        }

        .skill-item {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 12px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            flex-shrink: 0;
        }

        .skill-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .skill-name {
            font-weight: bold;
            color: #333;
            font-size: 0.95em;
        }

        .skill-level {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 0.8em;
        }

        .skill-slider-container {
            margin-bottom: 6px;
        }

        .skill-slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        .skill-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .skill-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .skill-levels {
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
        }

        .skill-input label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .skill-input select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .skill-input select:focus {
            outline: none;
            border-color: #667eea;
        }

        .chips-section {
            background: white;
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            flex: 0 0 auto;
        }

        .chips-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }

        .chip-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .chip-label {
            flex: 0 0 70px;
            font-weight: bold;
            color: #555;
            font-size: 0.9em;
        }

        .chip-input {
            flex: 1;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            text-align: center;
            transition: border-color 0.3s;
        }

        .chip-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .calculate-btn {
            display: block;
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .calculate-btn:active {
            transform: translateY(0);
        }

        .result-section {
            padding: 15px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 12px;
            color: white;
            display: none;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            flex: 1;
            min-height: 0;
            margin-bottom: 0;
        }

        .result-title {
            font-size: 1.1em;
            margin-bottom: 12px;
            text-align: center;
            font-weight: bold;
        }

        .result-content {
            display: flex;
            gap: 12px;
        }

        .result-column {
            flex: 1;
        }

        .result-title {
            font-size: 0.95em;
            font-weight: bold;
            margin-bottom: 8px;
            text-align: center;
            opacity: 0.9;
        }

        .result-grid {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .result-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
        }

        .result-item .chip-type {
            font-weight: bold;
            font-size: 0.85em;
        }

        .result-item .value {
            font-size: 1.1em;
            font-weight: bold;
        }

        .shortage-count {
            color: #ffeb3b;
        }

        .shortage-count.enough {
            color: #4CAF50;
        }

        .info-text {
            text-align: center;
            color: #666;
            margin-top: 8px;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>绝区零技能芯片计算器</h1>

        <div class="main-content">
            <div class="left-panel">
                <div class="section">
                    <div class="section-title">技能等级设置</div>
                    <div class="skills-list">
                        <div class="skill-item">
                            <div class="skill-header">
                                <span class="skill-name">普通攻击</span>
                                <span class="skill-level" id="level1-display">12级</span>
                            </div>
                            <div class="skill-slider-container">
                                <input type="range" class="skill-slider" id="skill1" min="0" max="12" value="12" step="1" oninput="updateSkillLevel(1)">
                            </div>
                            <div class="skill-levels">
                                <span>未升级</span>
                                <span>1级</span>
                                <span>6级</span>
                                <span>12级</span>
                            </div>
                        </div>

                        <div class="skill-item">
                            <div class="skill-header">
                                <span class="skill-name">闪避</span>
                                <span class="skill-level" id="level2-display">12级</span>
                            </div>
                            <div class="skill-slider-container">
                                <input type="range" class="skill-slider" id="skill2" min="0" max="12" value="12" step="1" oninput="updateSkillLevel(2)">
                            </div>
                            <div class="skill-levels">
                                <span>未升级</span>
                                <span>1级</span>
                                <span>6级</span>
                                <span>12级</span>
                            </div>
                        </div>

                        <div class="skill-item">
                            <div class="skill-header">
                                <span class="skill-name">支援技</span>
                                <span class="skill-level" id="level3-display">12级</span>
                            </div>
                            <div class="skill-slider-container">
                                <input type="range" class="skill-slider" id="skill3" min="0" max="12" value="12" step="1" oninput="updateSkillLevel(3)">
                            </div>
                            <div class="skill-levels">
                                <span>未升级</span>
                                <span>1级</span>
                                <span>6级</span>
                                <span>12级</span>
                            </div>
                        </div>

                        <div class="skill-item">
                            <div class="skill-header">
                                <span class="skill-name">特殊技</span>
                                <span class="skill-level" id="level4-display">12级</span>
                            </div>
                            <div class="skill-slider-container">
                                <input type="range" class="skill-slider" id="skill4" min="0" max="12" value="12" step="1" oninput="updateSkillLevel(4)">
                            </div>
                            <div class="skill-levels">
                                <span>未升级</span>
                                <span>1级</span>
                                <span>6级</span>
                                <span>12级</span>
                            </div>
                        </div>

                        <div class="skill-item">
                            <div class="skill-header">
                                <span class="skill-name">连携技</span>
                                <span class="skill-level" id="level5-display">12级</span>
                            </div>
                            <div class="skill-slider-container">
                                <input type="range" class="skill-slider" id="skill5" min="0" max="12" value="12" step="1" oninput="updateSkillLevel(5)">
                            </div>
                            <div class="skill-levels">
                                <span>未升级</span>
                                <span>1级</span>
                                <span>6级</span>
                                <span>12级</span>
                            </div>
                        </div>
                    </div>
                    <div class="info-text">芯片转换比例：1个A级芯片 = 3个B级芯片 = 9个C级芯片</div>
                </div>
            </div>

            <div class="right-panel">
                <div class="chips-section">
                    <div class="section-title">现有芯片数量</div>
                    <div class="chips-list">
                        <div class="chip-item">
                            <span class="chip-label">C级芯片</span>
                            <input type="number" class="chip-input" id="chip-c" min="0" value="0" placeholder="输入数量">
                        </div>
                        <div class="chip-item">
                            <span class="chip-label">B级芯片</span>
                            <input type="number" class="chip-input" id="chip-b" min="0" value="0" placeholder="输入数量">
                        </div>
                        <div class="chip-item">
                            <span class="chip-label">A级芯片</span>
                            <input type="number" class="chip-input" id="chip-a" min="0" value="0" placeholder="输入数量">
                        </div>
                    </div>
                    <button class="calculate-btn" onclick="calculate()">计算芯片需求</button>
                </div>

                <div class="result-section" id="result">
                    <div class="result-title">芯片需求计算结果</div>
                    <div class="result-content">
                        <div class="result-column">
                            <div class="result-title">总需求</div>
                            <div class="result-grid">
                                <div class="result-item">
                                    <span class="chip-type">C级芯片</span>
                                    <span class="value" id="total-c">0</span>
                                </div>
                                <div class="result-item">
                                    <span class="chip-type">B级芯片</span>
                                    <span class="value" id="total-b">0</span>
                                </div>
                                <div class="result-item">
                                    <span class="chip-type">A级芯片</span>
                                    <span class="value" id="total-a">0</span>
                                </div>
                            </div>
                        </div>
                        <div class="result-column">
                            <div class="result-title">缺口</div>
                            <div class="result-grid">
                                <div class="result-item">
                                    <span class="chip-type">C级芯片</span>
                                    <span class="value shortage-count" id="shortage-c">0</span>
                                </div>
                                <div class="result-item">
                                    <span class="chip-type">B级芯片</span>
                                    <span class="value shortage-count" id="shortage-b">0</span>
                                </div>
                                <div class="result-item">
                                    <span class="chip-type">A级芯片</span>
                                    <span class="value shortage-count" id="shortage-a">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 技能升级芯片消耗配置 (从1级开始计算)
        const LEVEL_REQUIREMENTS = {
            1: { c: 0, b: 0, a: 0 },  // 1级
            2: { c: 2, b: 0, a: 0 },  // 1->2级
            3: { c: 3, b: 0, a: 0 },  // 2->3级
            4: { c: 0, b: 2, a: 0 },  // 3->4级
            5: { c: 0, b: 3, a: 0 },  // 4->5级
            6: { c: 0, b: 4, a: 0 },  // 5->6级
            7: { c: 0, b: 6, a: 0 },  // 6->7级
            8: { c: 0, b: 0, a: 5 },  // 7->8级
            9: { c: 0, b: 0, a: 8 },  // 8->9级
            10: { c: 0, b: 0, a: 10 }, // 9->10级
            11: { c: 0, b: 0, a: 12 }, // 10->11级
            12: { c: 0, b: 0, a: 15 }  // 11->12级
        };

        // 芯片转换比例
        const CHIP_CONVERSION = {
            a_to_b: 3,  // 1A = 3B
            a_to_c: 9,  // 1A = 9C
            b_to_c: 3   // 1B = 3C
        };

        function updateSkillLevel(skillNum) {
            const slider = document.getElementById(`skill${skillNum}`);
            const display = document.getElementById(`level${skillNum}-display`);
            const level = parseInt(slider.value);

            if (level === 0) {
                display.textContent = '未升级';
            } else {
                display.textContent = level + '级';
            }
        }

        function calculate() {
            // 获取技能等级
            const skillLevels = [];
            for (let i = 1; i <= 5; i++) {
                const level = parseInt(document.getElementById(`skill${i}`).value);
                skillLevels.push(level);
            }

            // 获取现有芯片数量
            const currentChips = {
                c: parseInt(document.getElementById('chip-c').value) || 0,
                b: parseInt(document.getElementById('chip-b').value) || 0,
                a: parseInt(document.getElementById('chip-a').value) || 0
            };

            // 计算总需求数量（累计计算）
            const totalNeeded = {
                c: 0,
                b: 0,
                a: 0
            };

            skillLevels.forEach(level => {
                if (level > 1) {
                    for (let i = 2; i <= level; i++) {
                        const req = LEVEL_REQUIREMENTS[i];
                        totalNeeded.c += req.c;
                        totalNeeded.b += req.b;
                        totalNeeded.a += req.a;
                    }
                }
            });

            // 计算芯片缺口（考虑转换）
            let shortage = calculateShortage(totalNeeded, currentChips);

            // 更新结果显示
            document.getElementById('total-c').textContent = totalNeeded.c;
            document.getElementById('total-b').textContent = totalNeeded.b;
            document.getElementById('total-a').textContent = totalNeeded.a;

            document.getElementById('shortage-c').textContent = shortage.c;
            document.getElementById('shortage-b').textContent = shortage.b;
            document.getElementById('shortage-a').textContent = shortage.a;

            // 设置颜色显示
            setChipColor('shortage-c', shortage.c === 0);
            setChipColor('shortage-b', shortage.b === 0);
            setChipColor('shortage-a', shortage.a === 0);

            // 添加足够的样式类
            document.getElementById('shortage-c').className = shortage.c === 0 ? 'value shortage-count enough' : 'value shortage-count';
            document.getElementById('shortage-b').className = shortage.b === 0 ? 'value shortage-count enough' : 'value shortage-count';
            document.getElementById('shortage-a').className = shortage.a === 0 ? 'value shortage-count enough' : 'value shortage-count';

            // 显示结果区域
            document.getElementById('result').style.display = 'block';
        }

        function calculateShortage(needed, have) {
            // 首先计算每种芯片的直接缺口
            let shortageA = Math.max(0, needed.a - have.a);
            let shortageB = Math.max(0, needed.b - have.b);
            let shortageC = Math.max(0, needed.c - have.c);

            // 如果有富余的A级芯片，可以转换为B级或C级来弥补缺口
            if (have.a > needed.a) {
                const surplusA = have.a - needed.a;

                // 首先用富余A级芯片弥补B级缺口
                if (shortageB > 0) {
                    const convertToB = Math.min(surplusA, Math.ceil(shortageB / CHIP_CONVERSION.a_to_b));
                    shortageB = Math.max(0, shortageB - convertToB * CHIP_CONVERSION.a_to_b);
                    surplusA -= convertToB;
                }

                // 然后用富余A级芯片弥补C级缺口
                if (shortageC > 0 && surplusA > 0) {
                    const convertToC = Math.min(surplusA, Math.ceil(shortageC / CHIP_CONVERSION.a_to_c));
                    shortageC = Math.max(0, shortageC - convertToC * CHIP_CONVERSION.a_to_c);
                    surplusA -= convertToC;
                }
            }

            // 如果还有富余的B级芯片，可以转换为C级来弥补C级缺口
            if (have.b > needed.b) {
                const surplusB = (have.b - needed.b) + (have.a > needed.a ? 0 : 0); // 包含A级转换后的B级

                if (shortageC > 0 && surplusB > 0) {
                    const convertToC = Math.min(surplusB, Math.ceil(shortageC / CHIP_CONVERSION.b_to_c));
                    shortageC = Math.max(0, shortageC - convertToC * CHIP_CONVERSION.b_to_c);
                }
            }

            // 重新计算基于已有资源的最优分配
            // 将所有现有资源转换为C级等价值，计算总缺口
            const totalHaveC = have.c + have.b * CHIP_CONVERSION.b_to_c + have.a * CHIP_CONVERSION.a_to_c;
            const totalNeededC = needed.c + needed.b * CHIP_CONVERSION.b_to_c + needed.a * CHIP_CONVERSION.a_to_c;

            if (totalHaveC >= totalNeededC) {
                // 资源足够，计算最优分配
                const usedA = Math.min(have.a, needed.a);
                const remainingA = have.a - usedA;

                const usedB = Math.min(have.b + Math.floor(remainingA * CHIP_CONVERSION.a_to_b), needed.b);
                const remainingB = have.b + Math.floor(remainingA * CHIP_CONVERSION.a_to_b) - usedB;

                shortageA = 0;
                shortageB = 0;
                shortageC = 0;
            }

            return {
                c: shortageC,
                b: shortageB,
                a: shortageA
            };
        }

        function setChipColor(elementId, isEnough) {
            const element = document.getElementById(elementId);
            if (isEnough) {
                element.style.color = '#4CAF50';  // 绿色表示足够
            } else {
                element.style.color = '#ffeb3b';  // 黄色表示缺少
            }
        }

        // 浏览器缩放检测和适配
        function handleZoomChange() {
            const container = document.querySelector('.container');
            const mainContent = document.querySelector('.main-content');

            // 添加缩放感知类
            container.classList.add('zoom-aware');
            mainContent.classList.add('zoom-aware');

            // 检测窗口大小变化（可能是缩放）
            const windowWidth = window.innerWidth;
            const containerWidth = container.offsetWidth;

            // 如果容器宽度接近窗口宽度，说明可能是在缩放
            if (containerWidth / windowWidth > 0.95) {
                container.style.maxWidth = '95vw';
            }

            // 根据视窗高度调整主内容高度
            const vh = window.innerHeight;
            if (vh < 700) {
                mainContent.style.height = '80vh';
            } else if (vh > 900) {
                mainContent.style.height = 'calc(100vh - 120px)';
            }
        }

        // 初始化所有技能为12级（因为通常都是想升满）
        window.onload = function() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`skill${i}`).value = '12';
                updateSkillLevel(i); // 初始化显示
            }

            // 初始化缩放检测
            handleZoomChange();
        };

        // 监听窗口大小变化（包括缩放）
        window.addEventListener('resize', handleZoomChange);

        // 监听缩放变化（Chrome, Edge等）
        window.addEventListener('wheel', function(e) {
            if (e.ctrlKey) {
                setTimeout(handleZoomChange, 100);
            }
        }, { passive: true });
    </script>
</body>
</html>
